let defaultConfig={protect_status:"disable",protect_type:"none",display_type:"none",protect_level:"8px"},delay=100,debug=!1;function log(e){1==debug&&console.log(e)}function setStorage(e,t){log("Storage: set "+e+"="+t),chrome.storage.sync.set({[e]:t})}function handlePopup(){log("Init: handle popup");let e={protect_status:"input[name=protect_status]",protect_type:"input[name=protect_type]",protect_level:"input[name=protect_level]",display_type:"input[name=display_type]"};chrome.storage.sync.get(null,(function(t){Object.entries(e).forEach((([n])=>{"protect_status"==n&&updateProtectStatusBox(t[n]),log("Finding "+e[n]+'[value="'+t[n]+'"]...');try{(o=document.querySelector(e[n]+'[value="'+t[n]+'"]')).setAttribute("checked",!0)}catch(t){var o;log("Can not find!"),log("Set to default..."),null!=(o=document.querySelector(e[n]+'[value="'+defaultConfig[n]+'"]'))&&o.setAttribute("checked",!0)}log("Done")}))}))}function updateProtectStatusBox(e){let t=document.getElementById("protect_status_box");"enable"==e?(t.classList.remove("bg-gray-300"),t.classList.add("bg-green-300"),t.querySelector("img").src="../icons/svgs/eye-with-line.svg"):(t.classList.remove("bg-green-300"),t.classList.add("bg-gray-300"),t.querySelector("img").src="../icons/svgs/eye.svg")}function saveChanges(){let e=document.querySelector('input[name="protect_status"]:checked').value,t=document.querySelector('input[name="protect_type"]:checked').value,n=document.querySelector('input[name="display_type"]:checked').value;setStorage("protect_status",e),setStorage("protect_type",t),setStorage("display_type",n),updateProtectStatusBox(e),log("Saved");let o=document.getElementById("alert");o.innerText="Saved! If nothing happens, please refresh the page for the changes to take effect!",o.classList.remove("hidden"),chrome.tabs.query({},(function(e){log(e);for(var t=0;t<e.length;++t)log(e[t].url),e[t].url.includes("messenger.com")&&chrome.tabs.sendMessage(e[t].id,{action:"reinject"},(function(e){log(e)}))}))}function init(){log("Init"),handlePopup()}init(),document.addEventListener("DOMContentLoaded",(function(){for(var e=document.getElementsByTagName("a"),t=0;t<e.length;t++)!function(){var n=e[t],o=n.href;n.onclick=function(){chrome.tabs.create({active:!0,url:o})}}()})),document.getElementById("save_btn").addEventListener("click",(function(e){saveChanges()}));
